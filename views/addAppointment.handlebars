<!-- ... (other form elements) ... -->

<div class="mb-3">
    <label for="dentistId" class="form-label">Dentist</label>
    <select class="form-select" id="dentistId" name="DentistNo" required onchange="updateAvailableSlots()">
        {{#each dentists}}
        <option value="{{id}}">{{Name}}</option>
        {{/each}}
    </select>
</div>

<div class="mb-3">
    <label for="availableSlots" class="form-label">Available Slots</label>
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="availableSlotsBody">
            <!-- Available slots will be dynamically populated here -->
        </tbody>
    </table>
</div>

<button type="submit" class="btn btn-primary">Add Appointment</button>

<script>
    function updateAvailableSlots() {
        const selectedDentistId = document.getElementById('DentistNo').value;

        // Fetch dentist availability based on the selected dentist ID
        // Replace the following fetch URL with your actual endpoint
        fetch(`/get-dentist-availability?dentistId=${selectedDentistId}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            },
        })
        .then(response => response.json())
        .then(data => {
            // Update the available slots table body with the fetched data
            const availableSlotsBody = document.getElementById('availableSlotsBody');
            availableSlotsBody.innerHTML = ''; // Clear previous rows

            // Add new rows based on the fetched availability data
            data.forEach(slot => {
                const row = document.createElement('tr');

                // Add date and time cells (replace with your actual date and time formats)
                const dateCell = document.createElement('td');
                dateCell.textContent = slot.date; // Replace with your date format
                row.appendChild(dateCell);

                const timeCell = document.createElement('td');
                timeCell.textContent = slot.time; // Replace with your time format
                row.appendChild(timeCell);

                // Add action cell with a button to select the slot
                const actionCell = document.createElement('td');
                const selectButton = document.createElement('button');
                selectButton.textContent = 'Select';
                selectButton.onclick = () => selectSlot(slot.date, slot.time);
                actionCell.appendChild(selectButton);
                row.appendChild(actionCell);

                availableSlotsBody.appendChild(row);
            });
        })
        .catch(error => console.error('Error fetching availability:', error));
    }

    function selectSlot(date, time) {
        // Handle the selected slot, e.g., update the form fields
        document.getElementById('date').value = date;
        document.getElementById('time').value = time;
    }
</script>
